# ESP32电机控制微信小程序

这是一个基于微信小程序平台的ESP32电机控制应用，通过蓝牙低功耗(BLE)技术实现与ESP32设备的通信，提供电机控制和调试功能。

## 项目概述

本项目是一个功能完整的微信小程序，专为ESP32电机控制系统设计。它提供了直观的用户界面来控制电机运行状态，实时查看设备信息，以及进行调试和测试。

## 功能特性

### 核心功能
- **电机控制**: 启动、停止、调速、方向控制
- **蓝牙连接**: 通过BLE与ESP32设备建立稳定连接
- **实时监控**: 显示电机运行状态、转速、温度等关键参数
- **参数配置**: 调整PID控制参数、限位设置等

### 调试功能
- **实时日志**: 查看设备运行日志和调试信息
- **数据监控**: 实时图表显示电机运行数据
- **命令测试**: 发送自定义命令测试设备响应
- **故障诊断**: 检测设备异常并提供诊断信息

### 用户界面
- **简洁直观**: 采用微信原生组件，操作流畅
- **响应式设计**: 适配不同屏幕尺寸的设备
- **深色模式**: 支持深色主题，保护视力

## 技术架构

### 前端技术栈
- **框架**: 微信小程序原生框架
- **语言**: JavaScript (ES6+)
- **样式**: WXSS (类CSS)
- **组件**: 微信小程序原生组件

### 通信协议
- **协议**: 蓝牙低功耗(BLE)
- **服务**: 自定义GATT服务和特征值
- **数据格式**: JSON格式数据交换
- **加密**: 支持通信数据加密

### 文件结构
```
esp32motor/
├── app.js                 # 小程序逻辑
├── app.json              # 小程序公共配置
├── app.wxss              # 小程序公共样式
├── project.config.json   # 项目配置文件
├── sitemap.json          # 微信索引配置文件
├── pages/                # 页面目录
│   ├── index/           # 主控制页面
│   ├── debug/           # 调试页面
│   └── logs/            # 日志页面
├── utils/               # 工具函数
│   ├── ble.js          # BLE通信模块
│   ├── util.js         # 通用工具函数
│   └── test-type-conversion.js # 测试数据转换
├── docs/               # 项目文档
│   ├── requirements.md # 需求文档
│   ├── ble-spec.md     # BLE通信规范
│   ├── test-report.md  # 测试报告
│   └── todo.md         # 开发任务清单
└── typings/            # TypeScript类型定义
    └── wx.d.ts         # 微信小程序API类型定义
```

## 快速开始

### 环境要求
- 微信开发者工具 (最新版本)
- 微信小程序账号
- ESP32开发板 (已烧录对应固件)

### 安装步骤

1. **克隆项目**
   ```bash
   git clone [项目地址]
   cd esp32motor
   ```

2. **导入项目**
   - 打开微信开发者工具
   - 点击"导入项目"
   - 选择项目根目录
   - 填写AppID (使用测试号或正式号)

3. **配置项目**
   - 检查 `project.config.json` 中的配置
   - 确认 `app.json` 中的页面路径正确
   - 根据需要修改 `app.js` 中的全局配置

4. **运行项目**
   - 点击"编译"按钮
   - 使用真机调试或模拟器预览

### 使用说明

#### 连接设备
1. 打开小程序，进入主页面
2. 点击"搜索设备"按钮
3. 选择对应的ESP32设备
4. 等待连接成功提示

#### 控制电机
1. 在主页面可以看到电机控制面板
2. 使用滑块调节电机转速
3. 点击方向按钮切换旋转方向
4. 点击启动/停止按钮控制电机运行

#### 调试功能
1. 点击底部"调试"标签进入调试页面
2. 查看实时数据图表
3. 发送自定义测试命令
4. 查看设备日志信息

## 开发文档

### BLE通信协议
详细的BLE通信协议规范请参考 [`docs/ble-spec.md`](docs/ble-spec.md)

### API接口
- **连接管理**: `utils/ble.js` 中提供了完整的BLE连接管理
- **数据通信**: 支持可靠的数据传输和错误处理
- **设备发现**: 自动发现和过滤ESP32设备

### 扩展开发
项目采用模块化设计，易于扩展新功能：

1. **添加新页面**: 在 `pages/` 目录下创建新页面
2. **扩展BLE功能**: 在 `utils/ble.js` 中添加新的通信协议
3. **自定义组件**: 可创建自定义组件复用UI元素

## 测试

### 单元测试
- 数据转换测试: `utils/test-type-conversion.js`
- BLE通信测试: 包含在调试页面中

### 集成测试
- 设备连接测试
- 功能完整性测试
- 性能压力测试

详细的测试报告请参考 [`docs/test-report.md`](docs/test-report.md)

## 贡献指南

欢迎提交Issue和Pull Request来改进这个项目！

### 开发规范
- 代码风格: 遵循微信小程序开发规范
- 提交信息: 使用清晰的提交描述
- 测试: 新功能需要添加相应测试

## 许可证

本项目采用MIT许可证 - 查看 [LICENSE](LICENSE) 文件了解详情

## 支持与联系

如有问题或建议，请通过以下方式联系：
- 提交GitHub Issue
- 发送邮件至项目维护者

## 更新日志

### v1.0.0 (2025-08-11)
- 初始版本发布
- 基础电机控制功能
- BLE通信支持
- 调试功能实现
- 完整文档和测试